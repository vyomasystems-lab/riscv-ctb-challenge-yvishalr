# riscv_ctb_challenge

This documentation elaborates on the bugs found and the solutions that I came up with for the RISCV CTB Challenge.

# Challenge Level 1

## Challenge 1 : Logical

In this challenge, running the Makefile through the `make` command produces the following compilation error.

![](/resources/1_1.png)

### Solution

This error was simply rectified by changing the respective lines in the `test.S` file.

1. The instruction in line number 15855 is changed to

```Assembly
and s7,ra,s4
```

2. The instruction at line number 25584 is changed to

```Assembly
and s5,t1,s0
```

After making these changes, running the Makefile produces a successful spike dump file.

![](/resources/1_2.png)

## Challenge 2 : Loop

Running the `make` command causes a halt and a spike dump file is not obtained.

![](/resources/2_1.png)

### Solution

A few changes were made to fix this loop bug. It was indentified that three consecutive addition operations were being made through a loop while reading operand values from the memory and after the last correct addition operation, the program would get stuck in a self loop. The initial operands fed to the program were as follows :

![](/resources/2_2.png)

My solution to such a problem was the introduction to a new test case where the addition check would fail and hence terminate the loop.

![](/resources/2_3.png)

The fourth addition would result in the wrong sum causing the loop to break now.

Running the Makefile now produces a successful spike dump file.

![](/resources/2_4.png)

# Challenge Level 2

## Challenge 1 : Instructions

Running the `make -m` command causes several compilation errors for unrecognized opcode as shown below :

![](/resources/3_1.png)

### Solution

Note that we are using the **RV32I ISA** environment. This bug is mainly caused due to the RV64M assembly instructions generated by **aapg** in the following line within the `rv32i.yaml` config file:

![](/resources/3_2.png)

Upon changing the integer in line 66 to `0`, the Makefile runs successfully and a spike dump file is obtained as shown below :

![](/resources/3_3.png)

## Challenge 2 : Exceptions

In this challenge, there is no yaml file given and must be written. For this, I made use of the `rv32i.yaml` from the previous challenge as a template and made small modifications to generate 10 exceptions.

### Solution

The following modifications are made within the template config file to be able to generate exceptions as required.

The given config file had the following values set within the **Exception Generation** section.

![](/resources/4_1.png)

The values are changed to the following :

![](/resources/4_2.png)

Running `make -m` after these changes produces the following output:

![](/resources/4_3.png)
![](/resources/4_4.png)

> Note : This yaml config file sometimes causes spike to freeze and requires couple more runs to generate a successful test. Use CTRL+C and then Q to exit spike and run `make clean` and try once again.
